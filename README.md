# Верификация комбинационных схем с помощью SAT‑решателя Z3

Проект реализует проверку эквивалентности комбинационных логических схем, заданных булевыми формулами, двумя независимыми способами: полным перебором по всем входным векторам и SAT‑подходом с использованием решателя Z3 и митора.
Формулы парсятся в абстрактное синтаксическое дерево (AST), которое либо вычисляется напрямую (брутфорс), либо отображается в булевы выражения Z3; также реализована генерация случайных формул, демонстрационные тесты и экспериментальное сравнение времени работы методов.

## Установка

- Требуется установленный Python 3.x.
- Установите зависимости командой:

```bash
pip install -r requirements.txt
```

- В проекте используются, в частности, библиотеки `z3-solver` (SAT‑решатель Z3) и `matplotlib` (для построения графиков по результатам бенчмарков).


## Использование

### 1. Интерактивная проверка формул

Для ручной проверки эквивалентности двух формул запустите:

```bash
python manual_test.py
```

- Скрипт запросит две формулы, проверит их синтаксис и выполнит проверку эквивалентности двумя методами: полным перебором и через Z3.
- На экран выводится вердикт (`equiv` / `diff`) и время работы каждого метода в миллисекундах.


### 2. Демонстрационные тесты

Запуск основного модуля:

```bash
python main.py
```

- Выполняется встроенная функция `demo()`, которая прогоняет набор заранее подготовленных и случайно сгенерированных пар булевых формул.
- Для каждой пары выводятся результаты обоих методов, суммарная статистика по числу успешно совпавших проверок и суммарное время работы.


### 3. Автоматический бенчмарк

Для экспериментального сравнения времени работы методов используйте:

```bash
python benchmark.py
```

- Для числа переменных от 2 до 25 генерируются серии случайных пар формул фиксированной глубины; часть пар делается заведомо эквивалентной, часть — независимыми формулами.
- Для каждой пары измеряется время работы брутфорса и метода на Z3, затем для каждого значения $n$ усредняется время и результаты сохраняются в файл `benchmark_results.csv`.


### 4. Построение графиков

После запуска бенчмарка можно визуализировать результаты:

```bash
python plot_benchmark.py
```

- Скрипт читает `benchmark_results.csv`, строит график зависимости среднего времени работы обоих методов от числа входных переменных и отображает его.
- Оси: по X — число входных переменных, по Y — среднее время в миллисекундах (логарифмическая шкала); график также сохраняется в файл `time_vs_vars.png`.


## Синтаксис булевых формул

- Переменные: `x0`, `x1`, `x2`, … (идентификаторы вида `x` + целый индекс используются как входы схемы).
- Допустимые операции: отрицание `!`, конъюнкция `&`, дизъюнкция `|`, импликация `->`, эквивалентность `<->`, а также круглые скобки `(` и `)`.
- Внутри проекта формула сначала лексически разбирается в токены, затем строится AST, из которого можно получить:
    - Python‑выражение для вычисления функции по словарю значений переменных (используется в полном переборе).
    - Булево выражение Z3 через функции `ast_to_z3` и `build_z3_circuit` (используется в SAT‑подходе).

Ограничение: реализация полного перебора поднимает исключение при числе входных переменных больше 25, чтобы избежать экспоненциально долгих вычислений.

## Структура проекта

- `main.py` — ядро проекта:
    - определения AST‑узлов для булевых формул, парсер строковых выражений, преобразование AST в Python‑ и Z3‑выражения;
    - реализация двух методов проверки эквивалентности: `check_equiv_bruteforce` (полный перебор) и `check_equiv_z3` (митор + Z3);
    - генерация случайных формул и функция `demo()` с набором тестов.
- `manual_test.py` — интерактивный режим: чтение формул с консоли, проверка синтаксиса через парсер из `main.py`, запуск обоих методов проверки и вывод результатов пользователю.
- `benchmark.py` — автоматический бенчмарк: генерация серий случайных формул для разных чисел переменных, замер и усреднение времени работы обоих методов, сохранение результатов в CSV.
- `plot_benchmark.py` — построение графика по файлу `benchmark_results.csv` с логарифмической шкалой по оси времени и сохранением изображения в `time_vs_vars.png`.
- `SAT-reshateli.docx` — текст исследовательской работы, описывающий теоретические основы задачи SAT, метод митора, особенности решателя Z3 и постановку экспериментов, лежащих в основе данного программного комплекса.
